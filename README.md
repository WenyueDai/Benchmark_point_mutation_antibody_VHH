(Keep updating 20250706)

# Benchmark_point_mutation_antibody_VHH

**Benchmark_point_mutation_antibody_VHH** is a package for scoring point mutations for either antibody or VHH using different models (ablang, esm1v, esm1f, antiberta, antifold, nanobert, pyrosetta, lm_design (still developing), tempro). It provides per-position log-likelihood changes for all 20 standard amino acids in both chains, and supports IMGT numbering via `abnumber` if available.

---

## Features

* Scores antibody heavy (VH) and light (VL) chain pairs & nanobody
* Computes log-likelihood deltas for all amino acid substitutions
* Handles CSV input and outputs a CSV file with mutation scores

---

## Requirements

Different environment yaml files are in folder environment.


**Example `input.csv`:**

```csv
name,format,vh,vl
sample1,VHVL,EVQLVESGGGLVQPGGSLRLSCAASGFT...,DIQMTQSPSSLSASVGDRVTITC...
sample2,Nanobody,QVQLVQSGAEVKKPGASVKVSCKASGYT...,
```

---

## Output

The output TSV will contain columns:

* `chain`: VH or VL
* `pos`: 1-based position within chain
* `wt`: wild-type amino acid
* `mt`: mutated amino acid
* `delta_log_likelihood`: change in log-likelihood for this mutation
* `mut_log_likelihood`: absolute log-likelihood of the mutation
* `wt_log_likelihood`: absolute log-likelihood of the wild-type
* `pos`:Sequential numbering
* `mutation_label`: simplified mutation label (currently uses Kabat position only)
* `sample`: sample name

## License

MIT License

## DOING
**Benchmark_point_mutation_antibody_1MLC**

This benchmark evaluates the ability of various computational models to predict the effects of single point mutations on antibody binding, using the 1MLC antibody structure and deep mutational scanning (DMS) experimental data as a reference.
- Structures were generated by either: AbodyBuilder2 or PDB: 1MLC (antigen removed)
- Each structure was tested in: Unrelaxed form or Relaxed form (via PyRosetta FastRelax, 5 cycles, Cartesian relax with backbone and side-chain)

***Summaries***
1. Correlation with Experimental DMS Scores

| Model         | Correlation (Estimate) | Observations                        |
| ------------- | ---------------------- | ----------------------------------- |
| **ESM-1f**    | ~0.5-0.6               | Strongest alignment with experiment |
| **Antifold**  | ~0.4-0.5               | Moderate alignment                  |
| **Ablang2**   | ~0.3-0.4               | Limited alignment                   |
| **PyRosetta** | < 0.2                  | Poor correlation with DMS data      |

Structural relaxation (before vs. after FastRelax) had minimal effect on correlation across all models.

2. Detection of Beneficial Mutations (Still need to do)
DMS identified 34 Fv positions with enhanced binding upon mutation. Most models predicted only a small fraction of these beneficial mutations:

| Model         | Predicted Beneficial Mutations | Recall Estimate (out of 34) |
| ------------- | ------------------------------ | --------------------------- |
| **ESM-1f**    | XXX                            | ~XXX%                        |
| **Antifold**  | XXX                            | ~XXX%                        |
| **Ablang2**   | XXX                            | ~XXX%                        |
| **PyRosetta** | XXX                            | ~XXX%                        |


3. Conclusions
- ESM-1f and Antifold show the highest consistency with DMS data for predicting affinity-enhancing mutations.
- PyRosetta scoring showed limited predictive power in this benchmark.
- Structural input source (AbodyBuilder2 vs. PDB) and FastRelax preprocessing had negligible impact on model performance.

3. Drawbacks to improve & Further works
- Use antigen-antibody complex structure as the starting pose, and remove antigen later on: should use antibody structure from pdb database without antigen combined. 
- Evaluate experimental binding affinity against model log likelihood without including antigen structural/sequence information: evaluate thermostability against log likelihood, which should have a more direct relationship with delta log likelihood than binding affinity.